# =============================================================================
# Meta-World SAC Cluster Configuration
# Based on TU Wien dataLAB Cluster Setup
# =============================================================================

# User Configuration (ÄNDERN für deinen User!)
export CLUSTER_USER="e11704784"

# Cluster Paths
export CLUSTER_PROJECT_DIR="/home/${CLUSTER_USER}/metaworld_project"
export CLUSTER_SAC_DIR="${CLUSTER_PROJECT_DIR}/source/rl_project_sac"
export CLUSTER_LOGS_DIR="${CLUSTER_PROJECT_DIR}/logs"
export CLUSTER_MODELS_DIR="${CLUSTER_PROJECT_DIR}/models"
export CLUSTER_WANDB_DIR="${CLUSTER_PROJECT_DIR}/wandb_cache"

# Container Configuration
export CLUSTER_SIF_PATH="/share/${CLUSTER_USER}/containers"
export CLUSTER_SIF_NAME="sac_metaworld.sif"
export CLUSTER_FULL_SIF_PATH="${CLUSTER_SIF_PATH}/${CLUSTER_SIF_NAME}"

# Singularity/Apptainer Binary
export CLUSTER_SINGULARITY_BIN="apptainer"

# Shared Storage (für Work Dirs & Caches)
export CLUSTER_WORK_ROOT="/share/${CLUSTER_USER}/metaworld_work"
export CLUSTER_CACHE_ROOT="/share/${CLUSTER_USER}/metaworld_cache"

# Container Internal Paths (werden gebunden)
export DOCKER_WORKSPACE_PATH="/workspace/rl_project_sac"
export DOCKER_PYTHON_EXECUTABLE="python"

# Python Environment
export PYTHON_UNBUFFERED="1"

# W&B Configuration (defaults to offline, can be overridden by caller)
export WANDB_MODE="${WANDB_MODE:-offline}"
export WANDB_DIR="${CLUSTER_WANDB_DIR}"
export WANDB_CACHE_DIR="${CLUSTER_WANDB_DIR}/.cache"

# MuJoCo Configuration
export MUJOCO_GL="osmesa"  # Headless rendering
export PYOPENGL_PLATFORM="osmesa"

# Validation
if [ ! -d "${CLUSTER_PROJECT_DIR}" ]; then
    echo "⚠️  Warning: CLUSTER_PROJECT_DIR does not exist: ${CLUSTER_PROJECT_DIR}"
fi

if [ ! -f "${CLUSTER_FULL_SIF_PATH}" ]; then
    echo "⚠️  Warning: Container not found: ${CLUSTER_FULL_SIF_PATH}"
fi
